#include "fractional.h"

const q31 pow2lookup[512] = {
2147483625,
2056437376,
1969251200,
1885761408,
1805811328,
1729250816,
1655936256,
1585730048,
1518500224,
1454120832,
1392470912,
1333434624,
1276901376,
1222764928,
1170923776,
1121280384,
1073741824,
1028218688,
984625600,
942880704,
902905664,
864625408,
827968128,
792865024,
759250112,
727060416,
696235456,
666717312,
638450688,
611382464,
585461888,
560640192,
536870912,
514109344,
492312800,
471440352,
451452832,
432312704,
413984064,
396432512,
379625056,
363530208,
348117728,
333358656,
319225344,
305691232,
292730944,
280320096,
268435456,
257054672,
246156400,
235720176,
225726416,
216156352,
206992032,
198216256,
189812528,
181765104,
174058864,
166679328,
159612672,
152845616,
146365472,
140160048,
134217728,
128527336,
123078200,
117860088,
112863208,
108078176,
103496016,
99108128,
94906264,
90882552,
87029432,
83339664,
79806336,
76422808,
73182736,
70080024,
67108864,
64263668,
61539100,
58930044,
56431604,
54039088,
51748008,
49554064,
47453132,
45441276,
43514716,
41669832,
39903168,
38211404,
36591368,
35040012,
33554432,
32131834,
30769550,
29465022,
28215802,
27019544,
25874004,
24777032,
23726566,
22720638,
21757358,
20834916,
19951584,
19105702,
18295684,
17520006,
16777216,
16065917,
15384775,
14732511,
14107901,
13509772,
12937002,
12388516,
11863283,
11360319,
10878679,
10417458,
9975792,
9552851,
9147842,
8760003,
8388608,
8032958,
7692387,
7366255,
7053950,
6754886,
6468501,
6194258,
5931641,
5680159,
5439339,
5208729,
4987896,
4776425,
4573921,
4380001,
4194304,
4016479,
3846193,
3683127,
3526975,
3377443,
3234250,
3097129,
2965820,
2840079,
2719669,
2604364,
2493948,
2388212,
2286960,
2190000,
2097152,
2008239,
1923096,
1841563,
1763487,
1688721,
1617125,
1548564,
1482910,
1420039,
1359834,
1302182,
1246974,
1194106,
1143480,
1095000,
1048576,
1004119,
961548,
920781,
881743,
844360,
808562,
774282,
741455,
710019,
679917,
651091,
623487,
597053,
571740,
547500,
524288,
502059,
480774,
460390,
440871,
422180,
404281,
387141,
370727,
355009,
339958,
325545,
311743,
298526,
285870,
273750,
262144,
251029,
240387,
230195,
220435,
211090,
202140,
193570,
185363,
177504,
169979,
162772,
155871,
149263,
142935,
136875,
131072,
125514,
120193,
115097,
110217,
105545,
101070,
96785,
92681,
88752,
84989,
81386,
77935,
74631,
71467,
68437,
65536,
62757,
60096,
57548,
55108,
52772,
50535,
48392,
46340,
44376,
42494,
40693,
38967,
37315,
35733,
34218,
32768,
31378,
30048,
28774,
27554,
26386,
25267,
24196,
23170,
22188,
21247,
20346,
19483,
18657,
17866,
17109,
16384,
15689,
15024,
14387,
13777,
13193,
12633,
12098,
11585,
11094,
10623,
10173,
9741,
9328,
8933,
8554,
8192,
7844,
7512,
7193,
6888,
6596,
6316,
6049,
5792,
5547,
5311,
5086,
4870,
4664,
4466,
4277,
4096,
3922,
3756,
3596,
3444,
3298,
3158,
3024,
2896,
2773,
2655,
2543,
2435,
2332,
2233,
2138,
2048,
1961,
1878,
1798,
1722,
1649,
1579,
1512,
1448,
1386,
1327,
1271,
1217,
1166,
1116,
1069,
1024,
980,
939,
899,
861,
824,
789,
756,
724,
693,
663,
635,
608,
583,
558,
534,
512,
490,
469,
449,
430,
412,
394,
378,
362,
346,
331,
317,
304,
291,
279,
267,
256,
245,
234,
224,
215,
206,
197,
189,
181,
173,
165,
158,
152,
145,
139,
133,
128,
122,
117,
112,
107,
103,
98,
94,
90,
86,
82,
79,
76,
72,
69,
66,
64,
61,
58,
56,
53,
51,
49,
47,
45,
43,
41,
39,
38,
36,
34,
33,
32,
30,
29,
28,
26,
25,
24,
23,
22,
21,
20,
19,
19,
18,
17,
16,
16,
15,
14,
14,
13,
12,
12,
11,
11,
10,
10,
9,
9,
9,
8,
8,
8,
7,
7,
7,
6,
6,
6,
5,
5,
5,
5,
4,
4,
4,
4,
4,
4,
3,
3,
3,
3,
3,
3,
2,
2,
2,
2,
2,
2,
2,
2,
2,
2,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0 
};



const q31 log2lookup[512] = {
-2080374784,
-603979752,
-536870900,
-497614735,
-469762042,
-448157814,
-430505875,
-415581373,
-402653181,
-391249707,
-381048952,
-371821247,
-363397013,
-355647468,
-348472510,
-341792784,
-335544318,
-329674786,
-324140844,
-318906185,
-313940090,
-309216342,
-304712384,
-300408670,
-296288150,
-292335861,
-288538605,
-284884676,
-281363647,
-277966189,
-274683921,
-271509288,
-268435455,
-265456216,
-262565923,
-259759418,
-257031981,
-254379277,
-251797321,
-249282436,
-246831226,
-244440546,
-242107478,
-239829312,
-237603521,
-235427752,
-233299807,
-231217627,
-229179286,
-227182976,
-225226998,
-223309754,
-221429741,
-219585540,
-217775812,
-215999292,
-214254783,
-212541152,
-210857325,
-209202283,
-207575057,
-205974730,
-204400425,
-202851310,
-201326591,
-199825513,
-198347352,
-196891421,
-195457059,
-194043638,
-192650555,
-191277232,
-189923117,
-188587681,
-187270414,
-185970829,
-184688457,
-183422850,
-182173573,
-180940210,
-179722362,
-178519644,
-177331682,
-176158121,
-174998615,
-173852831,
-172720448,
-171601156,
-170494657,
-169400661,
-168318889,
-167249070,
-166190943,
-165144256,
-164108763,
-163084229,
-162070422,
-161067122,
-160074112,
-159091183,
-158118134,
-157154766,
-156200890,
-155256321,
-154320877,
-153394386,
-152476676,
-151567584,
-150666949,
-149774614,
-148890429,
-148014245,
-147145920,
-146285313,
-145432289,
-144586714,
-143748461,
-142917404,
-142093419,
-141276388,
-140466194,
-139662723,
-138865866,
-138075514,
-137291561,
-136513905,
-135742446,
-134977085,
-134217727,
-133464279,
-132716649,
-131974748,
-131238488,
-130507786,
-129782557,
-129062720,
-128348195,
-127638906,
-126934774,
-126235727,
-125541691,
-124852595,
-124168368,
-123488944,
-122814254,
-122144233,
-121478817,
-120817943,
-120161550,
-119509577,
-118861965,
-118218656,
-117579594,
-116944722,
-116313986,
-115687332,
-115064709,
-114446064,
-113831346,
-113220508,
-112613499,
-112010272,
-111410780,
-110814977,
-110222819,
-109634260,
-109049257,
-108467768,
-107889751,
-107315164,
-106743967,
-106176120,
-105611584,
-105050321,
-104492293,
-103937462,
-103385793,
-102837250,
-102291797,
-101749400,
-101210025,
-100673638,
-100140206,
 -99609697,
 -99082079,
 -98557321,
 -98035392,
 -97516261,
 -96999900,
 -96486277,
 -95975365,
 -95467135,
 -94961558,
 -94458609,
 -93958258,
 -93460480,
 -92965248,
 -92472536,
 -91982320,
 -91494572,
 -91009270,
 -90526388,
 -90045903,
 -89567790,
 -89092027,
 -88618590,
 -88147457,
 -87678605,
 -87212014,
 -86747660,
 -86285522,
 -85825580,
 -85367813,
 -84912199,
 -84458720,
 -84007355,
 -83558085,
 -83110889,
 -82665750,
 -82222648,
 -81781565,
 -81342482,
 -80905381,
 -80470245,
 -80037056,
 -79605796,
 -79176449,
 -78748997,
 -78323425,
 -77899715,
 -77477851,
 -77057817,
 -76639597,
 -76223177,
 -75808540,
 -75395671,
 -74984555,
 -74575178,
 -74167524,
 -73761579,
 -73357330,
 -72954761,
 -72553859,
 -72154611,
 -71757002,
 -71361019,
 -70966650,
 -70573880,
 -70182697,
 -69793088,
 -69405041,
 -69018543,
 -68633582,
 -68250145,
 -67868221,
 -67487798,
 -67108863,
 -66731406,
 -66355415,
 -65980878,
 -65607785,
 -65236124,
 -64865884,
 -64497054,
 -64129624,
 -63763584,
 -63398922,
 -63035628,
 -62673693,
 -62313105,
 -61953856,
 -61595935,
 -61239331,
 -60884037,
 -60530042,
 -60177336,
 -59825910,
 -59475756,
 -59126863,
 -58779223,
 -58432827,
 -58087666,
 -57743731,
 -57401013,
 -57059504,
 -56719196,
 -56380080,
 -56042147,
 -55705390,
 -55369800,
 -55035369,
 -54702089,
 -54369953,
 -54038952,
 -53709079,
 -53380326,
 -53052686,
 -52726151,
 -52400713,
 -52076366,
 -51753101,
 -51430912,
 -51109792,
 -50789734,
 -50470730,
 -50152773,
 -49835858,
 -49519976,
 -49205122,
 -48891288,
 -48578468,
 -48266656,
 -47955845,
 -47646028,
 -47337200,
 -47029353,
 -46722483,
 -46416581,
 -46111644,
 -45807663,
 -45504635,
 -45202551,
 -44901408,
 -44601198,
 -44301916,
 -44003556,
 -43706113,
 -43409581,
 -43113955,
 -42819228,
 -42525396,
 -42232453,
 -41940393,
 -41649212,
 -41358904,
 -41069464,
 -40780887,
 -40493167,
 -40206300,
 -39920280,
 -39635103,
 -39350763,
 -39067256,
 -38784576,
 -38502720,
 -38221682,
 -37941457,
 -37662041,
 -37383429,
 -37105616,
 -36828598,
 -36552371,
 -36276929,
 -36002269,
 -35728386,
 -35455276,
 -35182933,
 -34911355,
 -34640536,
 -34370473,
 -34101161,
 -33832596,
 -33564774,
 -33297691,
 -33031342,
 -32765724,
 -32500833,
 -32236665,
 -31973215,
 -31710481,
 -31448457,
 -31187141,
 -30926528,
 -30666615,
 -30407398,
 -30148872,
 -29891036,
 -29633884,
 -29377413,
 -29121620,
 -28866501,
 -28612052,
 -28358271,
 -28105153,
 -27852695,
 -27600893,
 -27349745,
 -27099246,
 -26849394,
 -26600185,
 -26351616,
 -26103683,
 -25856384,
 -25609715,
 -25363672,
 -25118254,
 -24873456,
 -24629275,
 -24385708,
 -24142753,
 -23900406,
 -23658664,
 -23417524,
 -23176983,
 -22937039,
 -22697687,
 -22458926,
 -22220752,
 -21983163,
 -21746155,
 -21509726,
 -21273873,
 -21038593,
 -20803883,
 -20569742,
 -20336165,
 -20103150,
 -19870694,
 -19638796,
 -19407451,
 -19176658,
 -18946414,
 -18716716,
 -18487562,
 -18258949,
 -18030874,
 -17803335,
 -17576330,
 -17349856,
 -17123911,
 -16898491,
 -16673595,
 -16449221,
 -16225365,
 -16002025,
 -15779200,
 -15556886,
 -15335082,
 -15113784,
 -14892991,
 -14672701,
 -14452910,
 -14233618,
 -14014821,
 -13796517,
 -13578705,
 -13361381,
 -13144544,
 -12928192,
 -12712322,
 -12496932,
 -12282021,
 -12067585,
 -11853623,
 -11640133,
 -11427113,
 -11214561,
 -11002474,
 -10790851,
 -10579689,
 -10368987,
 -10158742,
  -9948953,
  -9739617,
  -9530734,
  -9322299,
  -9114313,
  -8906772,
  -8699676,
  -8493021,
  -8286807,
  -8081031,
  -7875691,
  -7670786,
  -7466314,
  -7262272,
  -7058660,
  -6855475,
  -6652715,
  -6450380,
  -6248466,
  -6046972,
  -5845897,
  -5645239,
  -5444995,
  -5245165,
  -5045747,
  -4846738,
  -4648138,
  -4449944,
  -4252155,
  -4054770,
  -3857786,
  -3661202,
  -3465016,
  -3269227,
  -3073833,
  -2878833,
  -2684224,
  -2490006,
  -2296177,
  -2102735,
  -1909679,
  -1717007,
  -1524718,
  -1332810,
  -1141281,
   -950131,
   -759357,
   -568959,
   -378934,
   -189281
};
